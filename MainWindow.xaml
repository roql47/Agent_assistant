<Window x:Class="AgentAssistant.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:ui="http://schemas.wpfui.com"
        Title="ÏóêÏù¥Ï†ÑÌä∏ ÎπÑÏÑú" 
        Height="300" 
        Width="250"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        Topmost="True"
        ShowInTaskbar="True"
        ResizeMode="NoResize"
        MouseLeftButtonDown="Window_MouseLeftButtonDown"
        MouseMove="Window_MouseMove"
        Loaded="Window_Loaded">
    
    <Window.Resources>
        <!-- Easing Ìï®Ïàò Î®ºÏ†Ä Ï†ïÏùò -->
        <SineEase x:Key="SineEase" EasingMode="EaseInOut"/>
        
        <!-- Ïï†ÎãàÎ©îÏù¥ÏÖò Î¶¨ÏÜåÏä§ -->
        <Storyboard x:Key="IdleAnimation" RepeatBehavior="Forever">
            <DoubleAnimation Storyboard.TargetName="CharacterTransform" 
                           Storyboard.TargetProperty="Y"
                           From="0" To="-10" Duration="0:0:1.5" 
                           AutoReverse="True" 
                           EasingFunction="{StaticResource SineEase}"/>
        </Storyboard>
        
        <Storyboard x:Key="WaveAnimation">
            <DoubleAnimation Storyboard.TargetName="CharacterRotate" 
                           Storyboard.TargetProperty="Angle"
                           From="0" To="15" Duration="0:0:0.2" 
                           AutoReverse="True" 
                           RepeatBehavior="3x"/>
        </Storyboard>
    </Window.Resources>
    
    <Grid>
        <!-- Í∑∏Î¶ºÏûê Ìö®Í≥º -->
        <Grid.Effect>
            <DropShadowEffect BlurRadius="20" ShadowDepth="0" Opacity="0.3" Color="#000000"/>
        </Grid.Effect>
        
        <!-- Î©îÏù∏ Ïª®ÌÖåÏù¥ÎÑà -->
        <Grid x:Name="MainContainer">
            <!-- ÎßêÌíçÏÑ† (Í∏∞Î≥∏Ï†ÅÏúºÎ°ú Ïà®ÍπÄ) -->
            <Border x:Name="SpeechBubble" 
                    Background="White" 
                    CornerRadius="15"
                    Padding="15"
                    Margin="10,10,10,0"
                    VerticalAlignment="Top"
                    MaxWidth="230"
                    Visibility="Collapsed">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="15" ShadowDepth="2" Opacity="0.2"/>
                </Border.Effect>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <TextBlock x:Name="SpeechText" 
                             Grid.Row="1"
                             Text="ÏïàÎÖïÌïòÏÑ∏Ïöî! Î¨¥ÏóáÏùÑ ÎèÑÏôÄÎìúÎ¶¥ÍπåÏöî?"
                             TextWrapping="Wrap"
                             Foreground="#2D3436"
                             FontSize="13"
                             HorizontalAlignment="Center"
                             VerticalAlignment="Center"/>
                </Grid>
            </Border>
            
            <!-- Í¥ÄÎ¶¨Ïûê Î™®Îìú Î≤ÑÌäº (Ïö∞ÏÉÅÎã®) -->
            <Button x:Name="AdminModeButton" 
                    ToolTip="Í¥ÄÎ¶¨Ïûê Î™®Îìú (Î∂ÄÏÑú Í¥ÄÎ¶¨)"
                    HorizontalAlignment="Right" 
                    VerticalAlignment="Top"
                    Width="30" 
                    Height="30"
                    Margin="0,5,5,0"
                    Background="#FF6B6B"
                    Foreground="White"
                    Click="AdminModeButton_Click"
                    FontSize="16"
                    FontWeight="Bold"
                    Padding="0">‚öôÔ∏è</Button>
            
            <!-- Ï∫êÎ¶≠ÌÑ∞ Ïª®ÌÖåÏù¥ÎÑà -->
            <Grid x:Name="CharacterContainer" 
                  Height="150" 
                  Width="150"
                  VerticalAlignment="Bottom"
                  Margin="0,0,0,10">
                <Grid.RenderTransform>
                    <TransformGroup>
                        <TranslateTransform x:Name="CharacterTransform"/>
                        <RotateTransform x:Name="CharacterRotate" CenterX="75" CenterY="75"/>
                    </TransformGroup>
                </Grid.RenderTransform>
                
                <!-- Ï∫êÎ¶≠ÌÑ∞ ÏõêÌòï Î∞∞Í≤Ω -->
                <Ellipse Fill="#6C5CE7" 
                         Width="120" 
                         Height="120"
                         VerticalAlignment="Center"
                         HorizontalAlignment="Center">
                    <Ellipse.Effect>
                        <DropShadowEffect BlurRadius="20" ShadowDepth="3" Opacity="0.3" Color="#6C5CE7"/>
                    </Ellipse.Effect>
                </Ellipse>
                
                <!-- Ï∫êÎ¶≠ÌÑ∞ ÏñºÍµ¥ -->
                <Canvas Width="120" Height="120" VerticalAlignment="Center" HorizontalAlignment="Center">
                    <!-- Îàà (ÏôºÏ™Ω) -->
                    <Ellipse Canvas.Left="30" Canvas.Top="35" 
                             Width="15" Height="20" 
                             Fill="White"/>
                    <Ellipse x:Name="LeftPupil" Canvas.Left="35" Canvas.Top="40" 
                             Width="8" Height="8" 
                             Fill="#2D3436">
                        <Ellipse.RenderTransform>
                            <TranslateTransform x:Name="LeftPupilTransform"/>
                        </Ellipse.RenderTransform>
                    </Ellipse>
                    
                    <!-- Îàà (Ïò§Î•∏Ï™Ω) -->
                    <Ellipse Canvas.Left="75" Canvas.Top="35" 
                             Width="15" Height="20" 
                             Fill="White"/>
                    <Ellipse x:Name="RightPupil" Canvas.Left="80" Canvas.Top="40" 
                             Width="8" Height="8" 
                             Fill="#2D3436">
                        <Ellipse.RenderTransform>
                            <TranslateTransform x:Name="RightPupilTransform"/>
                        </Ellipse.RenderTransform>
                    </Ellipse>
                    
                    <!-- ÏûÖ -->
                    <Path Data="M 40,70 Q 60,85 80,70" 
                          Stroke="White" 
                          StrokeThickness="4" 
                          StrokeStartLineCap="Round" 
                          StrokeEndLineCap="Round"
                          Fill="Transparent"/>
                    
                    <!-- Î≥º ÌïòÏù¥ÎùºÏù¥Ìä∏ (ÏôºÏ™Ω) -->
                    <Ellipse Canvas.Left="20" Canvas.Top="55" 
                             Width="20" Height="15" 
                             Fill="#FF6B9D" 
                             Opacity="0.3"/>
                    
                    <!-- Î≥º ÌïòÏù¥ÎùºÏù¥Ìä∏ (Ïò§Î•∏Ï™Ω) -->
                    <Ellipse Canvas.Left="80" Canvas.Top="55" 
                             Width="20" Height="15" 
                             Fill="#FF6B9D" 
                             Opacity="0.3"/>
                </Canvas>
            </Grid>
            
            <!-- Ïª®Ìä∏Î°§ Î≤ÑÌäº (Ïö∞Ï∏° ÏÉÅÎã®) - Ïà®ÍπÄ -->
            <StackPanel Orientation="Horizontal" 
                       HorizontalAlignment="Right" 
                       VerticalAlignment="Top"
                       Margin="0,8,8,0"
                       Visibility="Collapsed">
                <Button Content="‚öôÔ∏è" 
                       Width="35" Height="35"
                       FontSize="16"
                       Style="{StaticResource MenuButtonStyle}"
                       Click="Settings_Click"
                       ToolTip="ÏÑ§Ï†ï"
                       Margin="0,0,3,0"/>
                <Button Content="‚ùå" 
                       Width="35" Height="35"
                       FontSize="16"
                       Style="{StaticResource MenuButtonStyle}"
                       Click="Close_Click"
                       ToolTip="Îã´Í∏∞"/>
            </StackPanel>
        </Grid>
        
        <!-- Ïª®ÌÖçÏä§Ìä∏ Î©îÎâ¥ -->
        <Grid.ContextMenu>
            <ContextMenu>
                <MenuItem Header="Ïù∏ÏÇ¨ÌïòÍ∏∞" Click="Greet_Click"/>
                <MenuItem Header="ÎèÑÏõÄÎßê ÌëúÏãú" Click="ShowHelp_Click"/>
                <MenuItem Header="ÎßêÌíçÏÑ† Ïà®Í∏∞Í∏∞" Click="HideBubble_Click"/>
                <Separator/>
                <MenuItem Header="üìÖ Ï∫òÎ¶∞Îçî ÏÉùÏÑ±" Click="OpenCalendar_Click"/>
                <MenuItem Header="üîç Ïù∏Ìä∏ÎùºÎÑ∑ Í≤åÏãúÌåê">
                    <MenuItem Header="üîê Î°úÍ∑∏Ïù∏ (ID/PW)" Click="IntranetLogin_Click"/>
                    <MenuItem Header="üîë Ïø†ÌÇ§ ÏûÖÎ†• (ÏàòÎèô)" Click="InputCookie_Click"/>
                    <MenuItem Header="üîç Ïø†ÌÇ§ ÏßÑÎã®" Click="DiagnoseCookies_Click"/>
                    <Separator/>
                    <MenuItem Header="üìã Í≥µÏßÄÏÇ¨Ìï≠" Click="CheckBoard_Notice_Click"/>
                    <MenuItem Header="üìë ÏóÖÎ¨¥Í∑úÏ†ï" Click="CheckBoard_WorkRules_Click"/>
                    <Separator/>
                    <MenuItem Header="üìß Î©îÏùºÌï®">
                        <MenuItem Header="üì• Î∞õÏùÄ Ìé∏ÏßÄÌï®" Click="CheckMail_Inbox_Click"/>
                        <MenuItem Header="üì§ Î≥¥ÎÇ∏ Ìé∏ÏßÄÌï®" Click="CheckMail_Sent_Click"/>
                    </MenuItem>
                </MenuItem>
                <Separator/>
                <MenuItem Header="ÏÑ§Ï†ï" Click="Settings_Click"/>
                <MenuItem Header="Ï¢ÖÎ£å" Click="Close_Click"/>
            </ContextMenu>
        </Grid.ContextMenu>
    </Grid>
</Window>



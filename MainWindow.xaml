<Window x:Class="AgentAssistant.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:ui="http://schemas.wpfui.com"
        Title="에이전트 비서" 
        Height="300" 
        Width="250"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        Topmost="True"
        ShowInTaskbar="True"
        ResizeMode="NoResize"
        MouseLeftButtonDown="Window_MouseLeftButtonDown"
        MouseMove="Window_MouseMove"
        Loaded="Window_Loaded">
    
    <Window.Resources>
        <!-- Easing 함수 먼저 정의 -->
        <SineEase x:Key="SineEase" EasingMode="EaseInOut"/>
        
        <!-- 애니메이션 리소스 -->
        <Storyboard x:Key="IdleAnimation" RepeatBehavior="Forever">
            <DoubleAnimation Storyboard.TargetName="CharacterTransform" 
                           Storyboard.TargetProperty="Y"
                           From="0" To="-10" Duration="0:0:1.5" 
                           AutoReverse="True" 
                           EasingFunction="{StaticResource SineEase}"/>
        </Storyboard>
        
        <Storyboard x:Key="WaveAnimation">
            <DoubleAnimation Storyboard.TargetName="CharacterRotate" 
                           Storyboard.TargetProperty="Angle"
                           From="0" To="15" Duration="0:0:0.2" 
                           AutoReverse="True" 
                           RepeatBehavior="3x"/>
        </Storyboard>
    </Window.Resources>
    
    <Grid>
        <!-- 그림자 효과 -->
        <Grid.Effect>
            <DropShadowEffect BlurRadius="20" ShadowDepth="0" Opacity="0.3" Color="#000000"/>
        </Grid.Effect>
        
        <!-- 메인 컨테이너 -->
        <Grid x:Name="MainContainer">
            <!-- 말풍선 (기본적으로 숨김) -->
            <Border x:Name="SpeechBubble" 
                    Background="White" 
                    CornerRadius="15"
                    Padding="15"
                    Margin="10,10,10,0"
                    VerticalAlignment="Top"
                    MaxWidth="230"
                    Visibility="Collapsed">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="15" ShadowDepth="2" Opacity="0.2"/>
                </Border.Effect>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <TextBlock x:Name="SpeechText" 
                             Grid.Row="1"
                             Text="안녕하세요! 무엇을 도와드릴까요?"
                             TextWrapping="Wrap"
                             Foreground="#2D3436"
                             FontSize="13"
                             HorizontalAlignment="Center"
                             VerticalAlignment="Center"/>
                </Grid>
            </Border>
            
            <!-- 캐릭터 컨테이너 -->
            <Grid x:Name="CharacterContainer" 
                  Height="150" 
                  Width="150"
                  VerticalAlignment="Bottom"
                  Margin="0,0,0,10">
                <Grid.RenderTransform>
                    <TransformGroup>
                        <TranslateTransform x:Name="CharacterTransform"/>
                        <RotateTransform x:Name="CharacterRotate" CenterX="75" CenterY="75"/>
                    </TransformGroup>
                </Grid.RenderTransform>
                
                <!-- 캐릭터 원형 배경 -->
                <Ellipse Fill="#6C5CE7" 
                         Width="120" 
                         Height="120"
                         VerticalAlignment="Center"
                         HorizontalAlignment="Center">
                    <Ellipse.Effect>
                        <DropShadowEffect BlurRadius="20" ShadowDepth="3" Opacity="0.3" Color="#6C5CE7"/>
                    </Ellipse.Effect>
                </Ellipse>
                
                <!-- 캐릭터 얼굴 -->
                <Canvas Width="120" Height="120" VerticalAlignment="Center" HorizontalAlignment="Center">
                    <!-- 눈 (왼쪽) -->
                    <Ellipse Canvas.Left="30" Canvas.Top="35" 
                             Width="15" Height="20" 
                             Fill="White"/>
                    <Ellipse x:Name="LeftPupil" Canvas.Left="35" Canvas.Top="40" 
                             Width="8" Height="8" 
                             Fill="#2D3436">
                        <Ellipse.RenderTransform>
                            <TranslateTransform x:Name="LeftPupilTransform"/>
                        </Ellipse.RenderTransform>
                    </Ellipse>
                    
                    <!-- 눈 (오른쪽) -->
                    <Ellipse Canvas.Left="75" Canvas.Top="35" 
                             Width="15" Height="20" 
                             Fill="White"/>
                    <Ellipse x:Name="RightPupil" Canvas.Left="80" Canvas.Top="40" 
                             Width="8" Height="8" 
                             Fill="#2D3436">
                        <Ellipse.RenderTransform>
                            <TranslateTransform x:Name="RightPupilTransform"/>
                        </Ellipse.RenderTransform>
                    </Ellipse>
                    
                    <!-- 입 -->
                    <Path Data="M 40,70 Q 60,85 80,70" 
                          Stroke="White" 
                          StrokeThickness="4" 
                          StrokeStartLineCap="Round" 
                          StrokeEndLineCap="Round"
                          Fill="Transparent"/>
                    
                    <!-- 볼 하이라이트 (왼쪽) -->
                    <Ellipse Canvas.Left="20" Canvas.Top="55" 
                             Width="20" Height="15" 
                             Fill="#FF6B9D" 
                             Opacity="0.3"/>
                    
                    <!-- 볼 하이라이트 (오른쪽) -->
                    <Ellipse Canvas.Left="80" Canvas.Top="55" 
                             Width="20" Height="15" 
                             Fill="#FF6B9D" 
                             Opacity="0.3"/>
                </Canvas>
            </Grid>
            
            <!-- 컨트롤 버튼 (우측 상단) - 숨김 -->
            <StackPanel Orientation="Horizontal" 
                       HorizontalAlignment="Right" 
                       VerticalAlignment="Top"
                       Margin="0,8,8,0"
                       Visibility="Collapsed">
                <Button Content="⚙️" 
                       Width="35" Height="35"
                       FontSize="16"
                       Style="{StaticResource MenuButtonStyle}"
                       Click="Settings_Click"
                       ToolTip="설정"
                       Margin="0,0,3,0"/>
                <Button Content="❌" 
                       Width="35" Height="35"
                       FontSize="16"
                       Style="{StaticResource MenuButtonStyle}"
                       Click="Close_Click"
                       ToolTip="닫기"/>
            </StackPanel>
        </Grid>
        
        <!-- 컨텍스트 메뉴 -->
        <Grid.ContextMenu>
            <ContextMenu>
                <MenuItem Header="인사하기" Click="Greet_Click"/>
                <MenuItem Header="도움말 표시" Click="ShowHelp_Click"/>
                <MenuItem Header="말풍선 숨기기" Click="HideBubble_Click"/>
                <Separator/>
                <MenuItem Header="📅 캘린더 생성" Click="OpenCalendar_Click"/>
                <MenuItem Header="🔍 인트라넷 게시판">
                    <MenuItem Header="🔐 로그인 (ID/PW)" Click="IntranetLogin_Click"/>
                    <MenuItem Header="🔑 쿠키 입력 (수동)" Click="InputCookie_Click"/>
                    <MenuItem Header="🔍 쿠키 진단" Click="DiagnoseCookies_Click"/>
                    <Separator/>
                    <MenuItem Header="📋 공지사항" Click="CheckBoard_Notice_Click"/>
                    <MenuItem Header="📑 업무규정" Click="CheckBoard_WorkRules_Click"/>
                    <Separator/>
                    <MenuItem Header="📧 메일함">
                        <MenuItem Header="📥 받은 편지함" Click="CheckMail_Inbox_Click"/>
                        <MenuItem Header="📤 보낸 편지함" Click="CheckMail_Sent_Click"/>
                    </MenuItem>
                </MenuItem>
                <Separator/>
                <MenuItem Header="설정" Click="Settings_Click"/>
                <MenuItem Header="종료" Click="Close_Click"/>
            </ContextMenu>
        </Grid.ContextMenu>
    </Grid>
</Window>


